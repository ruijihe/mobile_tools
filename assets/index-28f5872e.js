import{a as ne,E as pe,F as he,d as F,G as _e,j as l,m as ve,k as N,t as le,H as U,i as J,I as D,w as se,J as I,q as fe,K as me,c as b,r as k,L as j,M as Q,_ as P,x as d,y as f,l as L,O as R,A as i,P as B,Q as K,R as we,S as z,T as W,z as w,U as T,V as x,B as X,W as A,X as S,Y as q,C as ae,D as ie,h as ge,g as be,Z as ee,$ as $e}from"./index-c2506c87.js";import{b as H,_ as Y}from"./index-7c80d4c7.js";import{u as V,m as O}from"./data-8fc160dd.js";import{a as oe}from"./function-call-823c341d.js";const[xe,M]=ne("cell"),ye={tag:ve("div"),icon:String,size:String,title:N,value:N,label:N,center:Boolean,isLink:Boolean,border:le,required:Boolean,iconPrefix:String,valueClass:U,labelClass:U,titleClass:U,titleStyle:null,arrowDirection:String,clickable:{type:Boolean,default:null}},ke=pe({},ye,he);var Fe=F({name:xe,props:ke,setup(e,{slots:o}){const c=_e(),a=()=>{if(o.label||J(e.label))return l("div",{class:[M("label"),e.labelClass]},[o.label?o.label():e.label])},_=()=>{var n;if(o.title||J(e.title)){const r=(n=o.title)==null?void 0:n.call(o);return Array.isArray(r)&&r.length===0?void 0:l("div",{class:[M("title"),e.titleClass],style:e.titleStyle},[r||l("span",null,[e.title]),a()])}},s=()=>{const n=o.value||o.default;if(n||J(e.value))return l("div",{class:[M("value"),e.valueClass]},[n?n():l("span",null,[e.value])])},t=()=>{if(o.icon)return o.icon();if(e.icon)return l(D,{name:e.icon,class:M("left-icon"),classPrefix:e.iconPrefix},null)},p=()=>{if(o["right-icon"])return o["right-icon"]();if(e.isLink){const n=e.arrowDirection&&e.arrowDirection!=="right"?`arrow-${e.arrowDirection}`:"arrow";return l(D,{name:n,class:M("right-icon")},null)}};return()=>{var n;const{tag:r,size:$,center:h,border:g,isLink:y,required:m}=e,u=(n=e.clickable)!=null?n:y,C={center:h,required:m,clickable:u,borderless:!g};return $&&(C[$]=!!$),l(r,{class:M(C),role:u?"button":void 0,tabindex:u?0:void 0,onClick:c},{default:()=>{var E;return[t(),_(),s(),p(),(E=o.extra)==null?void 0:E.call(o)]}})}}});const ce=se(Fe),[Ce,te]=ne("cell-group"),Be={title:String,inset:Boolean,border:le};var Ie=F({name:Ce,inheritAttrs:!1,props:Be,setup(e,{slots:o,attrs:c}){const a=()=>{var s;return l("div",fe({class:[te({inset:e.inset}),{[me]:e.border&&!e.inset}]},c),[(s=o.default)==null?void 0:s.call(o)])},_=()=>l("div",{class:te("title",{inset:e.inset})},[o.title?o.title():e.title]);return()=>e.title||o.title?l(I,null,[_(),a()]):a()}});const re=se(Ie);const Se=F({setup(){const e=V(),o=b(()=>e.calculatorState),c=b(()=>e.floorResult),a=b(()=>e.calculatorType),_=b(()=>e.calculatorValue),s=e.updateInputArr,t=k(""),p=e.changeCalculator,n=H.keyList,r=j("px2rem"),$=m=>{const u=Function;return new u(`return ${m}`)()};let h=!0;const g=k("isInput"),y=m=>{if(m.value==="=")try{t.value=Math.floor($(t.value)).toString()}catch(u){t.value="Error"}else if(m.value==="AC")t.value="";else if(m.value!=="CM"){if(m.icon==="houtui")t.value=t.value.toString().slice(0,-1);else if(m.value!=="取消")if(m.value==="OK"){try{t.value=Math.floor($(t.value)).toString()}catch(u){t.value="Error"}a.value==="floorResult"?e.$patch({floorResult:t.value}):a.value==="roomWidth"?(e.$patch({globalObj:{width:t.value}}),window.editor.list.changeRoomByInputForMobile.dispatch({roomWidth:t.value})):a.value==="roomHeight"?(e.$patch({globalObj:{height:t.value}}),window.editor.list.changeRoomByInputForMobile.dispatch({roomHeight:t.value})):a.value==="wallWidth"?(e.$patch({globalObj:{width:t.value}}),window.editor.list.changeRoomByInputForMobile.dispatch({wallWidth:t.value})):a.value==="wallHeight"?(e.$patch({globalObj:{height:t.value}}),window.editor.list.changeRoomByInputForMobile.dispatch({wallHeight:t.value})):a.value==="point"?(e.$patch({globalObj:{angle:t.value}}),window.editor.list.changeRoomByInputForMobile.dispatch({angle:t.value})):a.value==="width"?(s(a.value,t.value),window.editor.list.changeRoomByInputForMobile.dispatch({doorWidth:t.value})):a.value==="leftWidth"?(s(a.value,t.value),window.editor.list.changeRoomByInputForMobile.dispatch({doorLeftWidth:t.value})):a.value==="rightWidth"&&(s(a.value,t.value),window.editor.list.changeRoomByInputForMobile.dispatch({doorRightWidth:t.value})),p("calculator")}else m.value===""||(h&&(t.value="",h=!1,g.value=""),t.value+=m.value)}};return Q(()=>{t.value=_.value,h=!0,g.value="isInput"}),{px2rem:r,keyList:n,store:e,calculatorState:o,changeCalculator:p,floorResult:c,result:t,handleButtonClick:y,calculatorValue:_,defaultValue:h,isInput:g}}});const Te={class:"calculatorState"},Le={class:"calculatorState-body"},Pe={class:"key-container"},Ee={class:"floorInputContainer bold font-n color-n"};function Me(e,o,c,a,_,s){const t=D,p=X;return d(),f(I,null,[L(i("div",{class:"overlay",onTouchstart:o[0]||(o[0]=B(n=>e.changeCalculator("overlay"),["stop"]))},null,544),[[R,e.calculatorState]]),L(i("div",Te,[i("div",Le,[i("div",Pe,[i("div",Ee,[L(i("input",{"onUpdate:modelValue":o[1]||(o[1]=n=>e.result=n),class:K([e.isInput,"floorInput"]),disabled:""},null,2),[[we,e.result,void 0,{trim:!0}]])]),(d(!0),f(I,null,z(e.keyList,n=>(d(),W(p,{key:n.value,color:n.color,class:K([n.class,"calculatorState-key flex-center color-n font-s"]),type:"success",onClick:r=>e.handleButtonClick(n)},{default:w(()=>[T(x(n.value)+" ",1),l(t,{size:"15",class:"iconfont buttonIcon","class-prefix":"icon",name:n.icon},null,8,["name"])]),_:2},1032,["color","class","onClick"]))),128))])])],512),[[R,e.calculatorState]])],64)}const ue=P(Se,[["render",Me],["__scopeId","data-v-4921fdae"]]),Re={class:"modelInfo"},De={class:"infoLeft"},ze={key:0,class:"infoRight flex-start"},We={key:0,class:"flex-start"},Oe={class:"font-l mh-2x"},Ae={key:0,class:"flex-start"},He=i("span",{class:"mr-1x font-l"},"x",-1),Ve={class:"buttonContainer flex-center"},je={key:1,class:"flex-start"},Ge=i("span",{class:"font-l mh-1x"},"墙",-1),Ne=i("span",{class:"mr-1x font-l"},"x",-1),Ue={class:"buttonContainer flex-center"},Je={key:2,class:"flex-start"},qe=i("span",{class:"font-l mh-1x"},"角度",-1),Ke={class:"buttonContainer flex-center"},Qe={key:3,class:"flex-start"},Xe={class:"font-l mh-1x"},Ye={class:"buttonContainer flex-center"},de=F({__name:"index",setup(e){const o=V();let c=[];const a=o.changeCalculator,_=o.changeShowModelInfo,s=b(()=>o.globalObj),t=(n,r)=>{r.lock=!r.lock,n?(r.icon="sisuo",r.class="checkedButton"):(r.icon="weisuoding",r.class="orangeButton")},p=n=>{switch(n.name){case"删除":window.editor.list.deleteForMobile.dispatch("del");break;case"位置":window.editor.list.lockUnlockForMobile.dispatch({positionLock:n.lock}),t(n.lock,c.value[3]);break;case"旋转":window.editor.list.lockUnlockForMobile.dispatch({rotationLock:n.lock}),t(n.lock,c.value[4]);break;case"长度":window.editor.list.lockUnlockForMobile.dispatch({lengthLock:n.lock}),o.$patch({globalObj:{lengthLock:n.lock}}),t(n.lock,c.value[2]);break;case"拆分墙":window.editor.list.wallOperate.dispatch({type:"splitWall"});break;case"停用补全":n.lock=!n.lock,window.editor.list.setWallParam.dispatch({autoCompletion:n.lock}),n.lock?c.value[1].class="checkedButton":c.value[1].class="orangeButton",oe({message:"此功能只适用于拖拽状态",position:"bottom"});break;case"横竖切换":n.lock=!n.lock,window.editor.list.setWallParam.dispatch({hvSwitch:n.lock}),n.lock?(c.value[2].class="checkedButton",c.value[2].icon="huangshuqihuan-shu"):(c.value[2].class="orangeButton",c.value[2].icon="huangshuqihuan-moren"),oe({message:"此功能只适用于拖拽状态",position:"bottom"});break;case"取消":_(!1,"drawWall"),window.editor.list.cancelTool.dispatch();break}};return Q(()=>{s.value.type==="room"?c=k(O.roomInfo):s.value.type==="wall"?c=k(O.wallInfo):s.value.type==="drawWall"?c=k(O.drawWallInfo):s.value.type==="point"?c=k(O.angleInfo):(s.value.type==="door"||s.value.type==="window")&&(c=k(O.doorWindowInfo))}),(n,r)=>{const $=Y,h=X,g=D,y=ue,m=A("router-view");return d(),f("div",Re,[l(m,null,{default:w(()=>[i("div",De,[(d(!0),f(I,null,z(S(c),u=>(d(),W($,{key:u.name,"class-name":u.class,"button-height":"70px",name:u.name,icon:u.icon,onTouchstart:C=>p(u)},null,8,["class-name","name","icon","onTouchstart"]))),128))]),s.value.type!=="drawWall"?(d(),f("div",ze,[s.value.type==="room"?(d(),f("div",We,[i("span",Oe,x(s.value.area)+" m²",1),s.value.width?(d(),f("div",Ae,[l(h,{class:"sizeButton font-l mh-2x",onTouchstart:r[0]||(r[0]=B(u=>S(a)("roomWidth",s.value.width),["stop"]))},{default:w(()=>[T(x(s.value.width)+"mm ",1)]),_:1}),He,l(h,{class:"sizeButton font-l mr-1x",onTouchstart:r[1]||(r[1]=B(u=>S(a)("roomHeight",s.value.height),["stop"]))},{default:w(()=>[T(x(s.value.height)+"mm ",1)]),_:1})])):q("",!0),l(h,{type:"success",class:"bg-orange color-n settingButton",to:"roomSetting"},{default:w(()=>[i("div",Ve,[l(g,{size:"15",class:"iconfont","class-prefix":"icon",name:"Project"})])]),_:1})])):s.value.type==="wall"?(d(),f("div",je,[Ge,l(h,{class:"sizeButton font-l mr-1x",onTouchstart:r[2]||(r[2]=B(u=>!s.value.lengthLock&&S(a)("wallWidth",s.value.width),["stop"]))},{default:w(()=>[T(x(s.value.width)+"mm ",1)]),_:1}),Ne,l(h,{class:"sizeButton font-l mr-1x",onTouchstart:r[3]||(r[3]=B(u=>S(a)("wallHeight",s.value.height),["stop"]))},{default:w(()=>[T(x(s.value.height)+"mm ",1)]),_:1}),l(h,{type:"success",class:"bg-orange color-n settingButton",to:"wallSetting"},{default:w(()=>[i("div",Ue,[l(g,{size:"15",class:"iconfont","class-prefix":"icon",name:"Project"})])]),_:1})])):s.value.type==="point"?(d(),f("div",Je,[qe,l(h,{class:"sizeButton font-l mr-1x",onTouchstart:r[4]||(r[4]=B(u=>S(a)("point",s.value.angle),["stop"]))},{default:w(()=>[T(x(s.value.angle)+"° ",1)]),_:1}),l(h,{type:"success",class:"bg-orange color-n settingButton",to:"pointSetting"},{default:w(()=>[i("div",Ke,[l(g,{size:"15",class:"iconfont","class-prefix":"icon",name:"Project"})])]),_:1})])):s.value.type==="door"||s.value.type==="window"?(d(),f("div",Qe,[i("span",Xe,x(s.value.type==="door"?"门":"窗"),1),(d(!0),f(I,null,z(s.value.inputArr,u=>(d(),W(h,{key:u.inputType,color:u.color,class:"sizeButton font-l mr-1x",onTouchstart:B(C=>!u.disabled&&S(a)(u.inputType,u.value),["stop"])},{default:w(()=>[T(x(u.value),1)]),_:2},1032,["color","onTouchstart"]))),128)),l(h,{type:"success",class:"bg-orange color-n settingButton",to:s.value.type==="door"?"doorSetting":"windowSetting"},{default:w(()=>[i("div",Ye,[l(g,{size:"15",class:"iconfont","class-prefix":"icon",name:"Project"})])]),_:1},8,["to"])])):q("",!0),l(y)])):q("",!0)]),_:1})])}}}),Ze={setup(){const e=V(),o=b(()=>e.showExport);return{exportPDF:()=>{window.editor.list.exportGLTF.dispatch("mobilePDF"),e.$patch({showExport:!1})},exportJPEG:()=>{window.editor.list.exportGLTF.dispatch("jpg"),e.$patch({showExport:!1})},showExport:o,closeExport:()=>{e.$patch({showExport:!1})}}}};const Z=e=>(ae("data-v-5106d6bb"),e=e(),ie(),e),eo={class:"export"},oo={class:"exportContainer"},to=Z(()=>i("div",{class:"font-l mb-2x"}," 导出为 ",-1)),no=Z(()=>i("span",null,"PDF 文档",-1)),lo=Z(()=>i("span",null,"JPEG 格式图片",-1));function so(e,o,c,a,_,s){const t=D;return d(),f("div",eo,[i("div",oo,[to,i("div",{class:"font-n mb-2x",onClick:o[0]||(o[0]=p=>a.exportPDF())},[l(t,{size:"20",class:"iconfont buttonIcon mr-1x","class-prefix":"icon",name:"PDFdocument"}),no]),i("div",{class:"font-n",onClick:o[1]||(o[1]=p=>a.exportJPEG())},[l(t,{size:"20",class:"iconfont buttonIcon mr-1x","class-prefix":"icon",name:"JPEGimage"}),lo])]),i("div",{class:"exportOverlay",onClick:o[2]||(o[2]=p=>a.closeExport())})])}const ao=P(Ze,[["render",so],["__scopeId","data-v-5106d6bb"]]),io=F({setup(){return{}}});const co=e=>(ae("data-v-4bd0f451"),e=e(),ie(),e),ro={class:"canvas_box"},uo=co(()=>i("div",{id:"box"},null,-1)),po=[uo];function ho(e,o,c,a,_,s){return d(),f("div",ro,po)}const _o=P(io,[["render",ho],["__scopeId","data-v-4bd0f451"]]),vo=F({name:"HandleFloor",setup(){return{handleFloorList:H.handleFloorList}}});const fo={class:"handleFloorContainer bg-orange"};function mo(e,o,c,a,_,s){const t=Y;return d(),f("div",fo,[(d(!0),f(I,null,z(e.handleFloorList,p=>(d(),W(t,{key:p.name,"class-name":"orangeButton","button-height":"70px",name:p.name,icon:p.icon},null,8,["name","icon"]))),128))])}const wo=P(vo,[["render",mo],["__scopeId","data-v-d5343487"]]),go=F({name:"EditorFloor",setup(){const e=j("px2rem"),o=V(),c=b(()=>o.floorResult),a=b(()=>o.calculatorState),_=o.changeCalculator;return{px2rem:e,calculatorState:a,store:o,changeCalculator:_,floorResult:c}}}),bo={class:"editorFloorContainer flex-start"},$o=i("span",{class:"font-l"},"未命名-01(47.01m²）",-1),xo={class:"font-l flex-center white"},yo={class:"buttonContainer flex-center"};function ko(e,o,c,a,_,s){const t=X,p=D;return d(),f("div",bo,[$o,l(t,{readonly:"",class:"mr-1x bg-orange floorHeight",onTouchstart:o[0]||(o[0]=B(n=>e.changeCalculator("floorResult","2000"),["stop"]))},{default:w(()=>[i("span",xo,x(e.floorResult)+"CM",1)]),_:1}),l(t,{type:"success",class:"bg-orange color-n floorSettingButton",to:"levelSetting"},{default:w(()=>[i("div",yo,[l(p,{size:"15",class:"iconfont white","class-prefix":"icon",name:"Project"})])]),_:1})])}const Fo=P(go,[["render",ko]]),Co=F({name:"NameFloor",setup(){return{px2rem:j("px2rem")}}}),Bo={class:"nameFloorContainer"};function Io(e,o,c,a,_,s){const t=ce,p=re;return d(),f("div",Bo,[l(p,{border:!1},{default:w(()=>[l(t,{border:!1,class:"font-s p-1x",title:"1F",value:"72㎡"}),l(t,{border:!1,class:"font-s p-1x",title:"2F",value:"72㎡"}),l(t,{border:!1,class:"font-s p-1x",title:"3F",value:"72㎡"}),l(t,{border:!1,class:"font-s p-1x",title:"4F",value:"72㎡"})]),_:1})])}const So=P(Co,[["render",Io]]),To=F({components:{HandleFloor:wo,EditorFloor:Fo,NameFloor:So,ModelInfo:de},setup(){ge(()=>{window.loadTime=setInterval(()=>{!window.editor.list||window.editor.list.pluginList._bindings.length===0||E()},100);const G=be().proxy.$router.currentRoute.value.name;e.$patch({modelType:G.toString()})});const e=V(),o=k(!1),c=b(()=>e.showExport),a=e.changeShowFloor,_=b(()=>e.showFloor),s=e.changeShowFloor,t=b(()=>e.showModelInfo),p=b(()=>e.showEditorToolRight),n=k(H.handelBtnList),r=H.handelBtnList,$=H.modelTypeList,h=b(()=>e.modelType),g=j("px2rem"),y=()=>{o.value=!0,h.value===""&&e.$patch({modelType:"model"})},m=v=>{e.$patch({modelType:v}),o.value=!1},u=()=>{a()},C=v=>{switch(v.name){case"Undo":window.editor.list.undo.dispatch();break;case"Redo":window.editor.list.redo.dispatch();break;case"3D":n.value[3].name="2D",window.editor.list.switchCamera.dispatch("3D");break;case"2D":n.value[3].name="3D",window.editor.list.switchCamera.dispatch("2D");break;case"del":break;case"清空":window.editor.list.deleteForMobile.dispatch(v.type);break;case"导出":e.$patch({showExport:!0});break}},E=()=>{window.editor.list.pluginList.dispatch("ok"),clearInterval(window.loadTime),delete window.loadTime};return Q(()=>{}),{show:o,showPopup:y,handelBtnList:n,modelBtnList:r,modelTypeList:$,hidePopup:m,px2rem:g,showFloor:_,showHandleFloor:u,modelType:h,handleClick:C,showModelInfo:t,changeShowModelInfo:s,showExport:c,showEditorToolRight:p}}});const Lo={class:"editorContainer"},Po={class:"editorToolLeft",scrollbar:!0},Eo={class:"e-t-l-container"},Mo={class:"e-t-top"},Ro={class:"e-t-bottom"},Do={class:"editorToolCenter"},zo={class:"editorFloor-right"},Wo={class:"editorToolRight"},Oo={class:"e-t-r-container"},Ao={class:"e-r-top"},Ho={class:"e-r-bottom"};function Vo(e,o,c,a,_,s){const t=_o,p=ao,n=Y,r=A("HandleFloor"),$=ue,h=A("EditorFloor"),g=A("NameFloor"),y=de,m=ce,u=re,C=$e,E=A("router-view");return d(),f("div",Lo,[l(t),L(l(p,null,null,512),[[R,e.showExport]]),i("div",Po,[i("div",Eo,[i("div",Mo,[(d(!0),f(I,null,z(e.handelBtnList,v=>(d(),W(n,{key:v.name,"button-height":"65px",name:v.name,icon:v.icon,onClick:G=>e.handleClick(v)},null,8,["name","icon","onClick"]))),128))]),i("div",Ro,[l(n,{name:"楼层","button-height":"65px",class:"floorButton","class-name":e.showFloor?"orangeButton":"whiteButton","icon-margin":"8px",icon:"ziyuanFloors17",onClick:o[0]||(o[0]=v=>e.showHandleFloor())},null,8,["class-name"])])])]),L(i("div",Do,[l(r),i("div",zo,[l($),l(h),l(g)])],512),[[R,e.showFloor]]),L(l(y,null,null,512),[[R,e.showModelInfo]]),L(i("div",Wo,[i("div",Oo,[i("div",Ao,[l(n,{icon:"youzhaixuanxiang","class-name":"titleButton","button-height":"30px",onClick:e.showPopup},null,8,["onClick"]),l(C,{show:e.show,"onUpdate:show":o[1]||(o[1]=v=>e.show=v),position:"right",overlay:!0,"overlay-style":{width:"100%",left:"0",background:"transparent"},style:ee({width:e.px2rem("195px"),height:"100%"})},{default:w(()=>[l(u,null,{default:w(()=>[(d(!0),f(I,null,z(e.modelTypeList,v=>(d(),W(m,{id:v.id,key:v.path,center:"",class:K([{active:e.modelType===v.id},"van-ellipsis"]),style:ee({fontSize:e.px2rem("16px"),height:e.px2rem("44px")}),title:v.value,to:v.path,onClick:G=>e.hidePopup(v.id)},null,8,["id","class","style","title","to","onClick"]))),128))]),_:1})]),_:1},8,["show","style"])]),i("div",Ho,[l(E)])])],512),[[R,e.showEditorToolRight]])])}const qo=P(To,[["render",Vo],["__scopeId","data-v-ec63d95b"]]);export{qo as default};
