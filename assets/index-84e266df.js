import{a as ne,E as pe,F as he,d as F,G as _e,j as l,m as ve,k as N,t as le,H as j,i as U,I as D,w as se,J as I,q as fe,K as me,c as g,r as y,L as G,M as q,_ as P,x as d,y as f,l as L,O as R,A as i,P as B,Q as J,R as we,S as z,T as W,z as w,U as S,V as x,B as K,W as A,X as T,Y as Z,C as ae,D as ie,h as ge,Z as $e,$ as ee,a0 as be}from"./index-f2e95837.js";import{b as H,_ as Q}from"./index-7cfce3aa.js";import{u as V,m as O}from"./data-bbf4041b.js";import{a as oe}from"./function-call-0e53838a.js";const[xe,M]=ne("cell"),ke={tag:ve("div"),icon:String,size:String,title:N,value:N,label:N,center:Boolean,isLink:Boolean,border:le,required:Boolean,iconPrefix:String,valueClass:j,labelClass:j,titleClass:j,titleStyle:null,arrowDirection:String,clickable:{type:Boolean,default:null}},ye=pe({},ke,he);var Fe=F({name:xe,props:ye,setup(e,{slots:o}){const c=_e(),a=()=>{if(o.label||U(e.label))return l("div",{class:[M("label"),e.labelClass]},[o.label?o.label():e.label])},h=()=>{var n;if(o.title||U(e.title)){const r=(n=o.title)==null?void 0:n.call(o);return Array.isArray(r)&&r.length===0?void 0:l("div",{class:[M("title"),e.titleClass],style:e.titleStyle},[r||l("span",null,[e.title]),a()])}},s=()=>{const n=o.value||o.default;if(n||U(e.value))return l("div",{class:[M("value"),e.valueClass]},[n?n():l("span",null,[e.value])])},t=()=>{if(o.icon)return o.icon();if(e.icon)return l(D,{name:e.icon,class:M("left-icon"),classPrefix:e.iconPrefix},null)},p=()=>{if(o["right-icon"])return o["right-icon"]();if(e.isLink){const n=e.arrowDirection&&e.arrowDirection!=="right"?`arrow-${e.arrowDirection}`:"arrow";return l(D,{name:n,class:M("right-icon")},null)}};return()=>{var n;const{tag:r,size:$,center:_,border:b,isLink:k,required:m}=e,u=(n=e.clickable)!=null?n:k,C={center:_,required:m,clickable:u,borderless:!b};return $&&(C[$]=!!$),l(r,{class:M(C),role:u?"button":void 0,tabindex:u?0:void 0,onClick:c},{default:()=>{var E;return[t(),h(),s(),p(),(E=o.extra)==null?void 0:E.call(o)]}})}}});const ce=se(Fe),[Ce,te]=ne("cell-group"),Be={title:String,inset:Boolean,border:le};var Ie=F({name:Ce,inheritAttrs:!1,props:Be,setup(e,{slots:o,attrs:c}){const a=()=>{var s;return l("div",fe({class:[te({inset:e.inset}),{[me]:e.border&&!e.inset}]},c),[(s=o.default)==null?void 0:s.call(o)])},h=()=>l("div",{class:te("title",{inset:e.inset})},[o.title?o.title():e.title]);return()=>e.title||o.title?l(I,null,[h(),a()]):a()}});const re=se(Ie);const Te=F({setup(){const e=V(),o=g(()=>e.calculatorState),c=g(()=>e.floorResult),a=g(()=>e.calculatorType),h=g(()=>e.calculatorValue),s=e.updateInputArr,t=y(""),p=e.changeCalculator,n=H.keyList,r=G("px2rem"),$=m=>{const u=Function;return new u(`return ${m}`)()};let _=!0;const b=y("isInput"),k=m=>{if(m.value==="=")try{t.value=Math.floor($(t.value)).toString()}catch(u){t.value="Error"}else if(m.value==="AC")t.value="";else if(m.value!=="CM"){if(m.icon==="houtui")t.value=t.value.toString().slice(0,-1);else if(m.value!=="取消")if(m.value==="OK"){try{t.value=Math.floor($(t.value)).toString()}catch(u){t.value="Error"}a.value==="floorResult"?e.$patch({floorResult:t.value}):a.value==="roomWidth"?(e.$patch({globalObj:{width:t.value}}),window.editor.list.changeRoomByInputForMobile.dispatch({roomWidth:t.value})):a.value==="roomHeight"?(e.$patch({globalObj:{height:t.value}}),window.editor.list.changeRoomByInputForMobile.dispatch({roomHeight:t.value})):a.value==="wallWidth"?(e.$patch({globalObj:{width:t.value}}),window.editor.list.changeRoomByInputForMobile.dispatch({wallWidth:t.value})):a.value==="wallHeight"?(e.$patch({globalObj:{height:t.value}}),window.editor.list.changeRoomByInputForMobile.dispatch({wallHeight:t.value})):a.value==="point"?(e.$patch({globalObj:{angle:t.value}}),window.editor.list.changeRoomByInputForMobile.dispatch({angle:t.value})):a.value==="width"?(s(a.value,t.value),window.editor.list.changeRoomByInputForMobile.dispatch({doorWidth:t.value})):a.value==="leftWidth"?(s(a.value,t.value),window.editor.list.changeRoomByInputForMobile.dispatch({doorLeftWidth:t.value})):a.value==="rightWidth"&&(s(a.value,t.value),window.editor.list.changeRoomByInputForMobile.dispatch({doorRightWidth:t.value})),p("calculator")}else m.value===""||(_&&(t.value="",_=!1,b.value=""),t.value+=m.value)}};return q(()=>{t.value=h.value,_=!0,b.value="isInput"}),{px2rem:r,keyList:n,store:e,calculatorState:o,changeCalculator:p,floorResult:c,result:t,handleButtonClick:k,calculatorValue:h,defaultValue:_,isInput:b}}});const Se={class:"calculatorState"},Le={class:"calculatorState-body"},Pe={class:"key-container"},Ee={class:"floorInputContainer bold font-n color-n"};function Me(e,o,c,a,h,s){const t=D,p=K;return d(),f(I,null,[L(i("div",{class:"overlay",onTouchstart:o[0]||(o[0]=B(n=>e.changeCalculator("overlay"),["stop"]))},null,544),[[R,e.calculatorState]]),L(i("div",Se,[i("div",Le,[i("div",Pe,[i("div",Ee,[L(i("input",{"onUpdate:modelValue":o[1]||(o[1]=n=>e.result=n),class:J([e.isInput,"floorInput"]),disabled:""},null,2),[[we,e.result,void 0,{trim:!0}]])]),(d(!0),f(I,null,z(e.keyList,n=>(d(),W(p,{key:n.value,color:n.color,class:J([n.class,"calculatorState-key flex-center color-n font-s"]),type:"success",onClick:r=>e.handleButtonClick(n)},{default:w(()=>[S(x(n.value)+" ",1),l(t,{size:"15",class:"iconfont buttonIcon","class-prefix":"icon",name:n.icon},null,8,["name"])]),_:2},1032,["color","class","onClick"]))),128))])])],512),[[R,e.calculatorState]])],64)}const ue=P(Te,[["render",Me],["__scopeId","data-v-3ed579ac"]]),Re={class:"modelInfo"},De={class:"infoLeft"},ze={class:"infoRight flex-start"},We={key:0,class:"flex-start"},Oe={class:"font-l mh-2x"},Ae={key:0,class:"flex-start"},He=i("span",{class:"mr-1x font-l"},"x",-1),Ve={class:"buttonContainer flex-center"},Ge={key:1,class:"flex-start"},Ne=i("span",{class:"font-l mh-1x"},"墙",-1),je=i("span",{class:"mr-1x font-l"},"x",-1),Ue={class:"buttonContainer flex-center"},Je={key:2,class:"flex-start"},qe=i("span",{class:"font-l mh-1x"},"角度",-1),Ke={key:3,class:"flex-start"},Qe={class:"font-l mh-1x"},de=F({__name:"index",setup(e){const o=V();let c=[];const a=o.changeCalculator,h=o.changeShowModelInfo,s=g(()=>o.globalObj),t=(n,r)=>{r.lock=!r.lock,n?(r.icon="sisuo",r.class="checkedButton"):(r.icon="weisuoding",r.class="orangeButton")},p=n=>{switch(n.name){case"删除":window.editor.list.deleteForMobile.dispatch("del");break;case"位置":window.editor.list.lockUnlockForMobile.dispatch({positionLock:n.lock}),t(n.lock,c.value[3]);break;case"旋转":window.editor.list.lockUnlockForMobile.dispatch({rotationLock:n.lock}),t(n.lock,c.value[4]);break;case"长度":window.editor.list.lockUnlockForMobile.dispatch({lengthLock:n.lock}),o.$patch({globalObj:{lengthLock:n.lock}}),t(n.lock,c.value[2]);break;case"拆分墙":window.editor.list.wallOperate.dispatch({type:"splitWall"});break;case"停用补全":n.lock=!n.lock,window.editor.list.setWallParam.dispatch({autoCompletion:n.lock}),n.lock?c.value[1].class="checkedButton":c.value[1].class="orangeButton",oe({message:"此功能只适用于拖拽状态",position:"bottom"});break;case"横竖切换":n.lock=!n.lock,window.editor.list.setWallParam.dispatch({hvSwitch:n.lock}),n.lock?(c.value[2].class="checkedButton",c.value[2].icon="huangshuqihuan-shu"):(c.value[2].class="orangeButton",c.value[2].icon="huangshuqihuan-moren"),oe({message:"此功能只适用于拖拽状态",position:"bottom"});break;case"取消":h(!1,"drawWall"),window.editor.list.cancelTool.dispatch();break}};return q(()=>{s.value.type==="room"?c=y(O.roomInfo):s.value.type==="wall"?c=y(O.wallInfo):s.value.type==="drawWall"?c=y(O.drawWallInfo):s.value.type==="point"?c=y(O.angleInfo):(s.value.type==="door"||s.value.type==="window")&&(c=y(O.doorWindowInfo))}),(n,r)=>{const $=Q,_=K,b=D,k=ue,m=A("router-view");return d(),f("div",Re,[l(m,null,{default:w(()=>[i("div",De,[(d(!0),f(I,null,z(T(c),u=>(d(),W($,{key:u.name,"class-name":u.class,"button-height":"70px",name:u.name,icon:u.icon,onTouchstart:C=>p(u)},null,8,["class-name","name","icon","onTouchstart"]))),128))]),i("div",ze,[s.value.type==="room"?(d(),f("div",We,[i("span",Oe,x(s.value.area)+" m²",1),s.value.width?(d(),f("div",Ae,[l(_,{class:"sizeButton font-l mh-2x",onTouchstart:r[0]||(r[0]=B(u=>T(a)("roomWidth",s.value.width),["stop"]))},{default:w(()=>[S(x(s.value.width)+"mm ",1)]),_:1}),He,l(_,{class:"sizeButton font-l mr-1x",onTouchstart:r[1]||(r[1]=B(u=>T(a)("roomHeight",s.value.height),["stop"]))},{default:w(()=>[S(x(s.value.height)+"mm ",1)]),_:1})])):Z("",!0),l(_,{type:"success",class:"bg-orange color-n settingButton",to:""},{default:w(()=>[i("div",Ve,[l(b,{size:"15",class:"iconfont","class-prefix":"icon",name:"Project"})])]),_:1})])):s.value.type==="wall"?(d(),f("div",Ge,[Ne,l(_,{class:"sizeButton font-l mr-1x",onTouchstart:r[2]||(r[2]=B(u=>!s.value.lengthLock&&T(a)("wallWidth",s.value.width),["stop"]))},{default:w(()=>[S(x(s.value.width)+"mm ",1)]),_:1}),je,l(_,{class:"sizeButton font-l mr-1x",onTouchstart:r[3]||(r[3]=B(u=>T(a)("wallHeight",s.value.height),["stop"]))},{default:w(()=>[S(x(s.value.height)+"mm ",1)]),_:1}),l(_,{type:"success",class:"bg-orange color-n settingButton",to:""},{default:w(()=>[i("div",Ue,[l(b,{size:"15",class:"iconfont","class-prefix":"icon",name:"Project"})])]),_:1})])):s.value.type==="point"?(d(),f("div",Je,[qe,l(_,{class:"sizeButton font-l mr-1x",onTouchstart:r[4]||(r[4]=B(u=>T(a)("point",s.value.angle),["stop"]))},{default:w(()=>[S(x(s.value.angle)+"° ",1)]),_:1})])):s.value.type==="door"||s.value.type==="window"?(d(),f("div",Ke,[i("span",Qe,x(s.value.type==="door"?"门":"窗"),1),(d(!0),f(I,null,z(s.value.inputArr,u=>(d(),W(_,{key:u.inputType,color:u.color,class:"sizeButton font-l mr-1x",onTouchstart:B(C=>!u.disabled&&T(a)(u.inputType,u.value),["stop"])},{default:w(()=>[S(x(u.value),1)]),_:2},1032,["color","onTouchstart"]))),128))])):Z("",!0),l(k)])]),_:1})])}}}),Xe={setup(){const e=V(),o=g(()=>e.showExport);return{exportPDF:()=>{window.editor.list.exportGLTF.dispatch("mobilePDF"),e.$patch({showExport:!1})},exportJPEG:()=>{window.editor.list.exportGLTF.dispatch("jpg"),e.$patch({showExport:!1})},showExport:o,closeExport:()=>{e.$patch({showExport:!1})}}}};const X=e=>(ae("data-v-5106d6bb"),e=e(),ie(),e),Ye={class:"export"},Ze={class:"exportContainer"},eo=X(()=>i("div",{class:"font-l mb-2x"}," 导出为 ",-1)),oo=X(()=>i("span",null,"PDF 文档",-1)),to=X(()=>i("span",null,"JPEG 格式图片",-1));function no(e,o,c,a,h,s){const t=D;return d(),f("div",Ye,[i("div",Ze,[eo,i("div",{class:"font-n mb-2x",onClick:o[0]||(o[0]=p=>a.exportPDF())},[l(t,{size:"20",class:"iconfont buttonIcon mr-1x","class-prefix":"icon",name:"PDFdocument"}),oo]),i("div",{class:"font-n",onClick:o[1]||(o[1]=p=>a.exportJPEG())},[l(t,{size:"20",class:"iconfont buttonIcon mr-1x","class-prefix":"icon",name:"JPEGimage"}),to])]),i("div",{class:"exportOverlay",onClick:o[2]||(o[2]=p=>a.closeExport())})])}const lo=P(Xe,[["render",no],["__scopeId","data-v-5106d6bb"]]),so=F({setup(){return{}}});const ao=e=>(ae("data-v-4bd0f451"),e=e(),ie(),e),io={class:"canvas_box"},co=ao(()=>i("div",{id:"box"},null,-1)),ro=[co];function uo(e,o,c,a,h,s){return d(),f("div",io,ro)}const po=P(so,[["render",uo],["__scopeId","data-v-4bd0f451"]]),ho=F({name:"HandleFloor",setup(){return{handleFloorList:H.handleFloorList}}});const _o={class:"handleFloorContainer bg-orange"};function vo(e,o,c,a,h,s){const t=Q;return d(),f("div",_o,[(d(!0),f(I,null,z(e.handleFloorList,p=>(d(),W(t,{key:p.name,"class-name":"orangeButton","button-height":"70px",name:p.name,icon:p.icon},null,8,["name","icon"]))),128))])}const fo=P(ho,[["render",vo],["__scopeId","data-v-d5343487"]]),mo=F({name:"EditorFloor",setup(){const e=G("px2rem"),o=V(),c=g(()=>o.floorResult),a=g(()=>o.calculatorState),h=o.changeCalculator;return{px2rem:e,calculatorState:a,store:o,changeCalculator:h,floorResult:c}}}),wo={class:"editorFloorContainer flex-start"},go=i("span",{class:"font-l"},"未命名-01(47.01m²）",-1),$o={class:"font-l flex-center white"},bo={class:"buttonContainer flex-center"};function xo(e,o,c,a,h,s){const t=K,p=D;return d(),f("div",wo,[go,l(t,{readonly:"",class:"mr-1x bg-orange floorHeight",onTouchstart:o[0]||(o[0]=B(n=>e.changeCalculator("floorResult","2000"),["stop"]))},{default:w(()=>[i("span",$o,x(e.floorResult)+"CM",1)]),_:1}),l(t,{type:"success",class:"bg-orange color-n floorSettingButton",to:"levelSetting"},{default:w(()=>[i("div",bo,[l(p,{size:"15",class:"iconfont white","class-prefix":"icon",name:"Project"})])]),_:1})])}const ko=P(mo,[["render",xo]]),yo=F({name:"NameFloor",setup(){return{px2rem:G("px2rem")}}}),Fo={class:"nameFloorContainer"};function Co(e,o,c,a,h,s){const t=ce,p=re;return d(),f("div",Fo,[l(p,{border:!1},{default:w(()=>[l(t,{border:!1,class:"font-s p-1x",title:"1F",value:"72㎡"}),l(t,{border:!1,class:"font-s p-1x",title:"2F",value:"72㎡"}),l(t,{border:!1,class:"font-s p-1x",title:"3F",value:"72㎡"}),l(t,{border:!1,class:"font-s p-1x",title:"4F",value:"72㎡"})]),_:1})])}const Bo=P(yo,[["render",Co]]),Io=F({components:{HandleFloor:fo,EditorFloor:ko,NameFloor:Bo,ModelInfo:de},setup(){ge(()=>{window.loadTime=setInterval(()=>{!window.editor.list||window.editor.list.pluginList._bindings.length===0||E()},100),$e().replace("/model")});const e=V(),o=y(!1),c=g(()=>e.showExport),a=e.changeShowFloor,h=g(()=>e.showFloor),s=e.changeShowFloor,t=g(()=>e.showModelInfo),p=g(()=>e.showEditorToolRight),n=y(H.handelBtnList),r=H.handelBtnList,$=H.modelTypeList,_=g(()=>e.modelType),b=G("px2rem"),k=()=>{o.value=!0,_.value===""&&e.$patch({modelType:"model"})},m=v=>{e.$patch({modelType:v}),o.value=!1},u=()=>{a()},C=v=>{switch(v.name){case"Undo":window.editor.list.undo.dispatch();break;case"Redo":window.editor.list.redo.dispatch();break;case"3D":n.value[3].name="2D",window.editor.list.switchCamera.dispatch("3D");break;case"2D":n.value[3].name="3D",window.editor.list.switchCamera.dispatch("2D");break;case"del":break;case"清空":window.editor.list.deleteForMobile.dispatch(v.type);break;case"导出":e.$patch({showExport:!0});break}},E=()=>{window.editor.list.pluginList.dispatch("ok"),clearInterval(window.loadTime),delete window.loadTime};return q(()=>{}),{show:o,showPopup:k,handelBtnList:n,modelBtnList:r,modelTypeList:$,hidePopup:m,px2rem:b,showFloor:h,showHandleFloor:u,modelType:_,handleClick:C,showModelInfo:t,changeShowModelInfo:s,showExport:c,showEditorToolRight:p}}});const To={class:"editorContainer"},So={class:"editorToolLeft",scrollbar:!0},Lo={class:"e-t-l-container"},Po={class:"e-t-top"},Eo={class:"e-t-bottom"},Mo={class:"editorToolCenter"},Ro={class:"editorFloor-right"},Do={class:"editorToolRight"},zo={class:"e-t-r-container"},Wo={class:"e-r-top"},Oo={class:"e-r-bottom"};function Ao(e,o,c,a,h,s){const t=po,p=lo,n=Q,r=A("HandleFloor"),$=ue,_=A("EditorFloor"),b=A("NameFloor"),k=de,m=ce,u=re,C=be,E=A("router-view");return d(),f("div",To,[l(t),L(l(p,null,null,512),[[R,e.showExport]]),i("div",So,[i("div",Lo,[i("div",Po,[(d(!0),f(I,null,z(e.handelBtnList,v=>(d(),W(n,{key:v.name,"button-height":"65px",name:v.name,icon:v.icon,onClick:Y=>e.handleClick(v)},null,8,["name","icon","onClick"]))),128))]),i("div",Eo,[l(n,{name:"楼层","button-height":"65px",class:"floorButton","class-name":e.showFloor?"orangeButton":"whiteButton","icon-margin":"8px",icon:"ziyuanFloors17",onClick:o[0]||(o[0]=v=>e.showHandleFloor())},null,8,["class-name"])])])]),L(i("div",Mo,[l(r),i("div",Ro,[l($),l(_),l(b)])],512),[[R,e.showFloor]]),L(l(k,null,null,512),[[R,e.showModelInfo]]),L(i("div",Do,[i("div",zo,[i("div",Wo,[l(n,{icon:"youzhaixuanxiang","class-name":"titleButton","button-height":"30px",onClick:e.showPopup},null,8,["onClick"]),l(C,{show:e.show,"onUpdate:show":o[1]||(o[1]=v=>e.show=v),position:"right",overlay:!0,"overlay-style":{width:"100%",left:"0",background:"transparent"},style:ee({width:e.px2rem("195px"),height:"100%"})},{default:w(()=>[l(u,null,{default:w(()=>[(d(!0),f(I,null,z(e.modelTypeList,v=>(d(),W(m,{id:v.id,key:v.path,center:"",class:J([{active:e.modelType===v.id},"van-ellipsis"]),style:ee({fontSize:e.px2rem("16px"),height:e.px2rem("44px")}),title:v.value,to:v.path,onClick:Y=>e.hidePopup(v.id)},null,8,["id","class","style","title","to","onClick"]))),128))]),_:1})]),_:1},8,["show","style"])]),i("div",Oo,[l(E)])])],512),[[R,e.showEditorToolRight]])])}const jo=P(Io,[["render",Ao],["__scopeId","data-v-d7dba05a"]]);export{jo as default};
